--- source/iked/ike.idb.phase1.cpp  2011-02-01 08:21:32.000000000 +0100
+++ source/iked/ike.idb.phase1.cpp    2020-05-27 13:01:15.195789694 +0200
@@ -676,7 +676,8 @@
    }
 
    xl.size( dh_size );
-   long result = BN_bn2bin( dh->pub_key, xl.buff() );
+   const BIGNUM *pub_key=DH_get0_pub_key(dh);
+   long result = BN_bn2bin( pub_key, xl.buff() );
 
    //
    // fixup public buffer alignment
