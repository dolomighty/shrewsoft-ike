--- source/libike/manager.file.cpp  2011-02-06 17:40:00.000000000 +0100
+++ source/libike/manager.file.cpp    2020-05-27 13:03:49.197959204 +0200
@@ -679,11 +679,10 @@
            BDATA pwd;
            data.get( pwd );
 
-           EVP_CIPHER_CTX ctx_cipher;
-           EVP_CIPHER_CTX_init( &ctx_cipher );
+           EVP_CIPHER_CTX *ctx_cipher=EVP_CIPHER_CTX_new();
 
            EVP_CipherInit_ex(
-               &ctx_cipher,
+               ctx_cipher,
                EVP_des_ede3_cbc(),
                NULL,
                key,
@@ -691,11 +690,13 @@
                0 );
 
            EVP_Cipher(
-               &ctx_cipher,
+               ctx_cipher,
                pwd.buff(),
                pwd.buff(),
                ( unsigned int ) pwd.size() );
 
+           EVP_CIPHER_CTX_free(ctx_cipher);
+
            pwlen -= pwd.buff()[ pwd.size() - 1 ];
            pwd.size( pwlen );
 
